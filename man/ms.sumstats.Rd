\name{ms.sumstats}
\alias{ms.sumstats}
%- Also NEED an '\alias' for EACH other topic documented here.
\title{Compute Summary Statistics from ms Simulations
%%  ~~function to do ... ~~
}
\description{This is an R encoded version of the Hudson sumstats program.  It accepts x$gametes as input, where x is generated by read.ms.output. The function returns a data frame of basic statistics for each simulated data set.
%%  ~~ A concise (1-5 lines) description of what the function does. ~~
}
\usage{
ms.sumstats(gametes)
}
%- maybe also 'usage' for other objects documented here.
\arguments{
  \item{gametes}{x$gametes, where x is the output from read.ms.output}
  }
\details{
This function largely replicates the executable program sumstats, distributed as part of ms.  It is designed to be used in conjunction with the ms function from the R package phyclust and the read.ms.output function.  Thus, the normal workflow would be as follows:
\enumerate{
\item Run ms (for information see help(ms)), specifying appropriate parameters.  
\item Convert the raw output to a list with read.ms.output, specifying the object created by ms with the txt= parameter
\item Execute this function, using the second element of the list ($gametes) as the sole argument
}
}
\value{
The function returns a data frame, the rows of which are the following for each replicate simulation:

\tabular{ll}{
S \tab Number of segregating sites \cr
pi \tab average pairwise differences between sequences \cr
th.W \tab the Watterson estimator of Theta \cr
Tajima.D \tab Tajima's D statistic \cr
th.H \tab Fay and Wu's estimator of theta \cr
H \tab Fay and Wu's H statistic
}
}
\references{
Hudson, R.R. (2002) “Generating Samples under a Wright-Fisher Neutral Model of Genetic Variation”, Bioinformatics, 18, 337-338. \url{http://home.uchicago.edu/~rhudson1/source.html}
}
\author{Bruce Cochrane \email{cochrabj@miamioh.edu}

%%  ~~who you are~~
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{

## Analyze ms run for 20 samples, 1000 replicates, and &theta; set to 10 

dat <-ms(nsam=20,nreps=1000,opts=("-t 10")) 
dat.ms <-read.ms.output(txt=dat)
dat.sum <-ms.sumstats(dat.ms$gametes)
head(dat.sum)


## The function is currently defined as
function (gametes) 

    sf <- lapply(gametes, sfs, pl = FALSE)  
    S <- sapply(sf, function(x) sum(x[[2]]))  
    pi <- sapply(sf, pi)  
    th.W <- sapply(sf, theta.W)  
    th.H <- sapply(sf, theta.H)  
    Tajima.D <- sapply(sf, taj)  
    H <- pi - th.H  
    out <- data.frame(S, pi, th.W, Tajima.D, th.H, H)  
    return(out)  
  
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.

\keyword{ms}

